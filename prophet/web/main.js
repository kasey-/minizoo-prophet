const _ = require('lodash');
const Papa = require('papaparse');
const axios = require('axios');

const csv = `"ds","y"
"2007-12-10",9.59076113897809
"2007-12-11",8.51959031601596
"2007-12-12",8.18367658262066
"2007-12-13",8.07246736935477
"2007-12-14",7.8935720735049
"2007-12-15",7.78364059622125
"2007-12-16",8.41405243249672
"2007-12-17",8.82922635473185
"2007-12-18",8.38251828808963
"2007-12-19",8.06965530688617
"2007-12-20",7.87929148508227
"2007-12-21",7.76174498465891
"2007-12-22",7.52940645783701
"2007-12-23",8.38526052015541
"2007-12-24",8.62011072542292
"2007-12-25",7.85243908535751
"2007-12-26",7.85399308722424
"2007-12-27",8.0519780789023
"2007-12-28",7.92660259918138
"2007-12-29",7.83834331555712
"2007-12-30",9.70314458114435
"2007-12-31",9.38597294061934
"2008-01-01",8.29379960884682
"2008-01-02",8.43468076984177
"2008-01-03",8.26204284396694
"2008-01-04",8.10681603894705
"2008-01-05",7.95014988765202
"2008-01-06",9.50925907635395
"2008-01-07",8.84678466694523
"2008-01-08",8.43054538469057
"2008-01-09",8.2482674474469
"2008-01-10",8.28172399041139
"2008-01-11",8.29279885820037
"2008-01-12",8.19918935907807
"2008-01-13",9.99652241850332
"2008-01-14",10.1270710070787
"2008-01-15",8.93379604393486
"2008-01-16",8.56617381363786
"2008-01-17",8.54772239645106
"2008-01-18",8.39976009452414
"2008-01-19",8.22309055116153
"2008-01-20",8.83898679349679`;

Papa.parse(csv, {
  dynamicTyping: true,
	complete: function(results) {
    const {data} = results;
		console.log(`${data.length} lines imported`);
		console.log(data.shift());
		console.log(_.take(data,6));
		console.log("...");
		console.log(_.takeRight(data,5));
    axios.post('http://127.0.0.1:5000/prophet/dataset', data)
    .then(function (response) {
      console.log(response.data);
    })
    .catch(function (error) {
      console.log(error);
    });
	}
});
